name: build and deploy (staging)

on:
  push:
    branches:
      - staging


jobs:
  tests:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      - name: Goto client and run tests
        run: cd web-app && npm i && npm test

  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Call webhook to deploy on staging
        run: echo 'Hello, about to trigger webhook 👷‍♀️' && curl ${{ secrets.URL_WEBHOOK_DEPLOY_STAGING }}